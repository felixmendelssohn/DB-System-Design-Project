/* 
 * Mohamed Ibrahim Khattab
 * 13101667
 * AMAZON_LIKE ONLINE STORE SCHEMA
 */

CREATE TABLE ADDRESS
(
  CID INT NOT NULL,
  City VARCHAR(100) NOT NULL,
  Street VARCHAR(100) NOT NULL,
  Building INT NOT NULL,
  Country VARCHAR(100) NOT NULL,
  PRIMARY KEY (CID)
);

CREATE TABLE DELIEVRY
(
  CID INT NOT NULL,
  OID INT NOT NULL,
  DATE1 DATE NOT NULL,
  PRIMARY KEY (CID),
  UNIQUE (OID)
);

CREATE TABLE PAYMENT
(
  OID INT NOT NULL,
  CID INT NOT NULL,
  AMOUNT INT NOT NULL,
  PRIMARY KEY (OID),
  UNIQUE (CID)
);

CREATE TABLE PRODUCT
(
  PROD_NUM INT NOT NULL,
  PROD_NAME INT NOT NULL,
  AMOUNT INT NOT NULL,
  PRICE INT NOT NULL,
  CATEGORY VARCHAR(20) NOT NULL,
  PRIMARY KEY (PROD_NUM)
);

CREATE TABLE ORDER1
(
  OID INT NOT NULL,
  CID INT NOT NULL,
  PROD_NUM INT NOT NULL,
  PRIMARY KEY (OID),
  FOREIGN KEY (CID) REFERENCES DELIEVRY(CID),
  FOREIGN KEY (PROD_NUM) REFERENCES PRODUCT(PROD_NUM),
  FOREIGN KEY (OID) REFERENCES PAYMENT(OID)
);

CREATE TABLE SUPPLIER
(
  SID INT NOT NULL,
  SNAME VARCHAR(100) NOT NULL,
  RATING INT NOT NULL,
  OID INT NOT NULL,
  CID INT NOT NULL,
  PRIMARY KEY (SID),
  FOREIGN KEY (OID) REFERENCES ORDER1(OID),
  FOREIGN KEY (CID) REFERENCES DELIEVRY(CID)
);

CREATE TABLE Owns
(
  PROD_NUM INT NOT NULL,
  SID INT NOT NULL,
  PRIMARY KEY (PROD_NUM, SID),
  FOREIGN KEY (PROD_NUM) REFERENCES PRODUCT(PROD_NUM),
  FOREIGN KEY (SID) REFERENCES SUPPLIER(SID)
);

CREATE TABLE ORDER_PROD_NUM
(
  PROD_NUM INT NOT NULL,
  OID INT NOT NULL,
  PRIMARY KEY (PROD_NUM, OID),
  FOREIGN KEY (OID) REFERENCES ORDER1(OID)
);

CREATE TABLE CUSTOMER
(
  CID INT NOT NULL,
  ADDRESS VARCHAR(100) NOT NULL,
  CNAME VARCHAR(100) NOT NULL,
  PHONES VARCHAR(100) NOT NULL,
  OID INT NOT NULL,
  PRIMARY KEY (CID),
  FOREIGN KEY (OID) REFERENCES ORDER1(OID),
  FOREIGN KEY (CID) REFERENCES ADDRESS(CID),
  FOREIGN KEY (CID) REFERENCES DELIEVRY(CID),
  FOREIGN KEY (OID) REFERENCES PAYMENT(OID)
);

INSERT INTO `ADDRESS` (`CID`, `City`, `Street`, `Building`, `Country`) VALUES ('123', 'Berlin', 'Main Street', '56', 'Germany');

INSERT INTO `ADDRESS` (`CID`, `City`, `Street`, `Building`, `Country`) VALUES ('456', 'Rio', 'Second Street', '498', 'Brazil'), ('789', 'Tokyo', 'Shinjiku Street', '3', 'Japan');

INSERT INTO `ADDRESS` (`CID`, `City`, `Street`, `Building`, `Country`) VALUES ('240', 'Dubai', 'Third Street', '387', 'UAE');

ALTER TABLE `ORDER1` ADD UNIQUE(`OID`);

INSERT INTO `PAYMENT` (`OID`, `CID`, `AMOUNT`) VALUES ('523576235', '123', '486');
INSERT INTO `PAYMENT` (`OID`, `CID`, `AMOUNT`) VALUES ('524745735', '240', '5089');
INSERT INTO `PAYMENT` (`OID`, `CID`, `AMOUNT`) VALUES ('523573535', '456', '120');

INSERT INTO `DELIEVRY` (`CID`, `OID`, `DATE1`) VALUES ('123', '45677889', '2016-12-09');
INSERT INTO `DELIEVRY` (`CID`, `OID`, `DATE1`) VALUES ('123', '523573535', '2016-12-05');
INSERT INTO `DELIEVRY` (`CID`, `OID`, `DATE1`) VALUES ('123', '523576235', '2016-12-02');

ALTER TABLE `PRODUCT` CHANGE `PROD_NAME` `PROD_NAME` VARCHAR(100) NOT NULL;
INSERT INTO `PRODUCT` (`PROD_NUM`, `PROD_NAME`, `AMOUNT`, `PRICE`, `CATEGORY`) VALUES ('41589', 'Samsung Smart TV', '5000', '460', 'TVS');
INSERT INTO `PRODUCT` (`PROD_NUM`, `PROD_NAME`, `AMOUNT`, `PRICE`, `CATEGORY`) VALUES ('41679', 'Huawei Mate 9', '6000', '760', 'Phones');
INSERT INTO `PRODUCT` (`PROD_NUM`, `PROD_NAME`, `AMOUNT`, `PRICE`, `CATEGORY`) VALUES ('45512', 'Google Glass', '7000', '1500', 'Electronics');
INSERT INTO `PRODUCT` (`PROD_NUM`, `PROD_NAME`, `AMOUNT`, `PRICE`, `CATEGORY`) VALUES ('41589', 'Samsung Smart TV', '5000', '460', 'TVS');


INSERT INTO `ORDER1` (`OID`, `CID`, `PROD_NUM`) VALUES ('523573535', '240', '41589');
INSERT INTO `ORDER1` (`OID`, `CID`, `PROD_NUM`) VALUES ('523576235', '123', '41679');
INSERT INTO `ORDER1` (`OID`, `CID`, `PROD_NUM`) VALUES ('524745735', '456', '45512');

INSERT INTO `SUPPLIER` (`SID`, `SNAME`, `RATING`, `OID`, `CID`) VALUES ('347', 'Walmart', '3', '524745735', '123');
INSERT INTO `SUPPLIER` (`SID`, `SNAME`, `RATING`, `OID`, `CID`) VALUES ('235', 'Taizen', '5', '523576235', '240');
INSERT INTO `SUPPLIER` (`SID`, `SNAME`, `RATING`, `OID`, `CID`) VALUES ('890', 'Hulu', '2', '524745735', '456');

INSERT INTO `CUSTOMER` (`CID`, `CNAME`, `PHONES`, `OID`) VALUES ('240', 'Makoto Nakamura', '+120 (467) 908-406', '523576235');
INSERT INTO `CUSTOMER` (`CID`, `CNAME`, `PHONES`, `OID`) VALUES ('456', 'John Bolton', '+20 (467) 908-456', '523576235');
INSERT INTO `CUSTOMER` (`CID`, `CNAME`, `PHONES`, `OID`) VALUES ('123', 'Jack Septiceye2', '+10 (456) 789-123', '524745735');


